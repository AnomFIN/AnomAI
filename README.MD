# AnomFIN ¬∑ JugiAI ‚Äì k√§ytt√∂√∂notto ja k√§ytt√∂opas

T√§m√§ asiakirja kokoaa yhteen kaikki vaiheet, joilla AnomAI/JugiAI puretaan, asennetaan ja otetaan k√§ytt√∂√∂n Windows-ymp√§rist√∂ss√§. Paketti sis√§lt√§√§ ohjatun asennuksen (`install.bat`), sovelluksen l√§hdekoodin (`jugiai.py`) sek√§ automaattisen EXE-rakentajan. Kun noudatat alla olevia vaiheita j√§rjestyksess√§, sovellus toimii heti purkamisen j√§lkeen ‚Äì aivan kuin junan vessa.

> **Allekirjoitus:** AnomFIN ¬∑ √Ñlykkyyden k√§ytt√∂√∂notto

---

## 1. Valmistelut

1. **Lataa uusin jakopaketti** GitHubista tai toimittamastasi l√§hteest√§ ja pura se haluamaasi kansioon (esim. `C:\AnomAI`).
2. **Varmista Python 3.10+ (64-bittinen)** on asennettuna. Jos sit√§ ei l√∂ydy, hae uusin versio osoitteesta [python.org](https://www.python.org/downloads/windows/).
3. (Valinnainen) **Poista aiempien versioiden j√§√§nn√∂kset** ‚Äì esimerkiksi vanhat `venv`-kansiot tai `dist`-kansiot.

---

## 2. Ohjattu asennus (`install.bat`)

Asennusohjelma k√§y l√§pi seuraavat vaiheet ja pit√§√§ ikkunan auki my√∂s virhetilanteissa, jotta n√§et selke√§t korjausohjeet:

### UTF-8-k√§ynnistin (`install_utf8.bat`)

* **Turvallinen koodisivun vaihto.** `install_utf8.bat` tunnistaa konsolin nykyisen koodisivun, yritt√§√§ vaihtaa UTF-8:aan ja palauttaa alkuper√§isen tilan, vaikka `install.bat` ep√§onnistuisi.
* **Rakenteinen lokitus.** Kaikki ilmoitukset tulostuvat JSON-muodossa (`{"component":"install_utf8", ...}`), joten ne on helppo ohjata lokity√∂kaluun tai liitt√§√§ tukipyynt√∂√∂n.
* **Virhesieto.** Jos koodisivun vaihto tai `install.bat`-haku ep√§onnistuu, skripti raportoi tilanteen, pit√§√§ prosessin k√§ynniss√§ ja antaa yksiselitteiset jatko-ohjeet.

1. **K√§ynnist√§ asennus** kaksoisklikkaamalla `install.bat`. Konsolin koodisivu vaihtuu automaattisesti UTF-8-muotoon, joten √§√§kk√∂set n√§kyv√§t oikein.
2. **Pythonin tunnistus ja tarkistus.** Skripti etsii asennetun Pythonin (`py -3`, `python`, `python3`) ja varmistaa, ett√§ k√§yt√∂ss√§ on v√§hint√§√§n 64-bittinen Python 3.10. Halutessasi voit sy√∂tt√§√§ oman polun.
3. **Virtuaaliymp√§rist√∂ `.venv`.** Projektiin luodaan automaattisesti `.venv`-kansio. Jos luonti ep√§onnistuu, jatketaan suoraan j√§rjestelm√§n Pythonilla, mutta suosittelemme k√§ytt√§m√§√§n virtuaaliymp√§rist√∂√§.
4. **Pip ja riippuvuudet.** Pip p√§ivitet√§√§n ja `requirements.txt` asennetaan. T√§m√§n j√§lkeen skripti kysyy, haluatko asentaa paikallisen LLM-tuen (`llama-cpp-python --prefer-binary`). Kaikki asennuskomennot jatkavat virhetilanteissa, jotta voit yritt√§√§ uudelleen tai ohittaa vaiheen hallitusti.
5. **JugiAI:n konfigurointi.** Vastaa ohjattuun lomakkeeseen (API-avain, malli, l√§mp√∂tila, taustakuva-asetukset jne.). Tiedot tallennetaan `config.json`-tiedostoon, ja tyhj√§ `history.json` luodaan automaattisesti.
6. **AnomAI.exe:n generointi.** Skripti asentaa PyInstaller-riippuvuudet, muuntaa `logo.png` ‚Üí `logo.ico`, koostaa `AnomAI.exe`-tiedoston ja kopioi sen projektin juureen. Samalla tuotetaan `dist\AnomAI`-hakemisto ja jakopaketti `AnomAI_Windows.zip`.
7. **Pikakuvake ty√∂p√∂yd√§lle.** Powershell-komento luo `AnomAI.lnk`-pikakuvakkeen ty√∂p√∂yd√§llesi ja k√§ytt√§√§ automaattisesti `logo.ico`-ikonia. Mahdolliset virheet (esim. jos ty√∂p√∂yt√§√§ ei l√∂ydy) raportoidaan.
8. **Yhteenveto.** Lopuksi n√§et listan luoduista tiedostoista ja ohjeen seuraaviin askeliin. Ikkuna pysyy auki, kunnes suljet sen (tai painat Enteri√§ `pause`-kehotteessa).

---

## 3. Ensimm√§inen k√§ynnistys

1. **K√§yt√§ ty√∂p√∂yd√§n `AnomAI`-pikakuvaketta** tai kaksoisklikkaa projektin juureen kopioitua `AnomAI.exe` -tiedostoa.
2. Vaihtoehtoisesti voit k√§ynnist√§√§ `start_jugiai.bat`-tiedoston. Se yritt√§√§ ensin avata `AnomAI.exe`-tiedoston ja palaa tarvittaessa Python-versioon (virtuaaliymp√§rist√∂ `.venv` ‚Üí `pythonw` ‚Üí `py -3` ‚Üí `python`).
3. Kun sovellus avautuu, ‚öôÔ∏è-kuvakkeen takaa l√∂ytyy Asetukset-paneeli, jossa voit hienos√§√§t√§√§ profiilia sek√§ valita paikallisen mallin, jos `llama-cpp-python` asennettiin.

### Virtuaaliymp√§rist√∂n aktivointi k√§sin

Jos haluat k√§ytt√§√§ komentorivi√§ suoraan (esimerkiksi asentaaksesi lis√§kirjastoja), aktivoi sama virtuaaliymp√§rist√∂, jonka `install.bat` loi:

```powershell
cd C:\Polku\AnomAI
Set-ExecutionPolicy -Scope Process RemoteSigned  # tarvittaessa
\.venv\Scripts\Activate.ps1   # PowerShell
```

Komentokehotteessa (`cmd.exe`) vastaava komento on:

```cmd
cd C:\Polku\AnomAI
\.venv\Scripts\activate
```

Aktivoinnin j√§lkeen `python` ja `pip` viittaavat automaattisesti oikeaan ymp√§rist√∂√∂n, joten paikallisen mallin tuki ja Pillow pysyv√§t k√§ytett√§viss√§.

---

## 4. P√§ivitys tai uudelleenrakennus

* **Asennuksen uudelleenk√§ytt√∂:** Aja `install.bat` uudelleen. Skripti tunnistaa olemassa olevan `venv`-kansion, konfiguraatiot ja EXE:n ja p√§ivitt√§√§ ne turvallisesti.
* **Pelkk√§ EXE-rakennus:** K√§yt√§ `build_exe.bat`-tiedostoa. Se luo tai p√§ivitt√§√§ `.venv_build`-ymp√§rist√∂n, tarkistaa Python-version (v√§hint√§√§n 3.10, 64-bit) ja kirjoittaa kaiken lokiin `build_exe.log`. Skripti tuottaa:
  - `dist\AnomAI\AnomAI.exe`
  - projektin juureen kopioidun `AnomAI.exe`
  - `AnomAI_Windows.zip`
* **L√§hdekoodin ajaminen:** Voit aina suorittaa `jugiai.py` suoraan (esim. `python jugiai.py`), mik√§li Python-riippuvuudet ovat kunnossa.

---

## 5. Vianetsint√§

| Ongelma | Syy | Ratkaisu |
| --- | --- | --- |
| `llama-cpp-python` asennus ep√§onnistuu (CMake-virheet) | Windowsilta puuttuu rakennusty√∂kalut tai sopiva py√∂r√§ | Asenna [Microsoft C++ Build Tools](https://visualstudio.microsoft.com/visual-cpp-build-tools/) ja yrit√§ `install.bat`:in ehdottamaa komentoa uudelleen. Vaihtoehtoisesti hae valmis bin√§√§ripy√∂r√§ osoitteesta [abetlen/llama-cpp-python releases](https://github.com/abetlen/llama-cpp-python/releases). Et√§-API toimii silti ilman paikallista mallia. |
| `build_exe.bat` pys√§htyy heti | Python ei ole 64-bittinen 3.10+ tai sit√§ ei l√∂ydy | Asenna [Python 3.10 64-bit](https://www.python.org/downloads/windows/) ja varmista, ett√§ `py -3` tai `python` osoittaa siihen. Tarkista lis√§tiedot `build_exe.log`-tiedostosta. |
| Pikakuvaketta ei synny | Ty√∂p√∂yd√§n polku ei ollut PowerShellin saatavilla | Luo pikakuvake manuaalisesti: hiiren oikea `AnomAI.exe` ‚Üí **L√§het√§** ‚Üí **Ty√∂p√∂yt√§ (luo pikakuvake)**. |
| `start_jugiai.bat` ei l√∂yd√§ Pythonia | Python puuttuu tai PATH-ymp√§rist√∂muuttuja ei sis√§ll√§ sit√§ | Asenna Python 3.10+ (64-bit) ja varmista, ett√§ asennuksen lopussa valitset ‚ÄúAdd python.exe to PATH‚Äù, tai k√§ynnist√§ `AnomAI.exe` suoraan. |
| Sovellus ei yhdist√§ OpenAI:hin | Virheellinen API-avain tai malli | Avaa ‚öôÔ∏è Asetukset ‚Üí OpenAI-v√§lilehti, sy√∂t√§ toimiva avain ja malli (esim. `gpt-4o-mini`). |
| `AnomAI.exe` sulkeutuu heti | Taustalla tapahtui poikkeus (esim. `llama-cpp-python` puuttuu nykyisest√§ ymp√§rist√∂st√§) | Katso virheilmoituksen kertoma polku `jugiai_error.log`-tiedostoon. Lokissa n√§kyy tarkka traceback ja k√§ytetty Python-polku. Korjaa syy (esim. suorita `"%CD%\.venv\Scripts\python.exe" -m pip install --upgrade --prefer-binary llama-cpp-python`) ja k√§ynnist√§ uudelleen. |
| `python jugiai.py` ‚Üí "Moduulia llama_cpp ei l√∂ydy" | Komento k√§ytt√§√§ Windows Storen python-stubia, jossa ei ole kirjastoja | Uusin versio yritt√§√§ automaattisesti k√§ynnist√§√§ `py -3 jugiai.py` -komennon puolestasi. Jos n√§et virheilmoituksen, avaa `start_jugiai.bat` tai aja `py -3 jugiai.py` k√§sin. Aktivoi `.venv` komennolla `\.venv\Scripts\activate`, jos sellainen on luotu. |

---

## 6. Projektiin sis√§ltyv√§t ty√∂kalut

| Tiedosto | Kuvaus |
| --- | --- |
| `install.bat` | T√§ydellinen k√§ytt√∂√∂nottoskripti: virtuaaliymp√§rist√∂, riippuvuudet, konfigurointi, EXE, pikakuvake. |
| `start_jugiai.bat` | √Ñlyk√§s k√§ynnistin, joka suosii `AnomAI.exe`:t√§ ja k√§ytt√§√§ Pythonia vain tarvittaessa. |
| `build_exe.bat` | Erillinen EXE-pakettien rakennus (samat virheenk√§sittelyt kuin asennuksessa) ja kattava loki `build_exe.log`-tiedostoon. |
| `make_ico.py` | Muuntaa `logo.png` ‚Üí `logo.ico` useissa resoluutioissa (vaatii Pillow-kirjaston). |
| `jugiai.py` | Tkinter-pohjainen p√§√§sovellus: OpenAI- ja paikallinen GGUF-tuki, profiilit, taustakuvat ja historia. |
| `config.json` / `history.json` | Luodaan automaattisesti. Konfiguraatio kirjoitetaan UTF-8-muodossa, jotta √§√§kk√∂set s√§ilyv√§t oikein. |
| `logo.png` | AnomFINin vesileima ja ikoni. Asennus tuottaa t√§st√§ `logo.ico`-version. |

---

## 7. Parhaat k√§yt√§nn√∂t ja ideat jatkokehitykseen

* **Moniprofiilit:** Aktivoi useita profiileja lis√§√§m√§ll√§ niit√§ `config.json`-tiedostoon. Asennusohjelma varmistaa, ett√§ `DEFAULT_PROFILE` on ajan tasalla.
* **Yritysk√§ytt√∂:** Voit kopioida `AnomAI_Windows.zip` -paketin sellaisenaan loppuk√§ytt√§jille. Paketti sis√§lt√§√§ kaiken tarvittavan, kunhan `config.json` on valmiiksi t√§ytetty.
* **Paikallinen mallikirjasto:** Sijoita `.gguf`-mallit esimerkiksi `models`-hakemistoon ja viittaa niihin sovelluksen asetuksissa, kun `llama-cpp-python` on asennettu.
* **Automaattip√§ivitys:** Lis√§kehitysideana voidaan tehd√§ skripti, joka tarkistaa GitHub-releaset ja p√§ivitt√§√§ sovelluksen yhdell√§ komennolla.

---

## 8. 2024-ulkoasup√§ivitys ja uudet toiminnot

* **Cyber-neon -teema:** Sovellus hy√∂dynt√§√§ nyt anomfin-website -sivuston kaltaista tummaa taustaa, turkooseja korostuksia ja selkeit√§ kortteja.
* **Tallenteiden katselu:** Uusi *Tallenteet*-n√§kym√§ n√§ytt√§√§ koko keskusteluhistorian listana. Valitse viesti selataksesi tai k√§yt√§ toistonappeja (‚ñ∂, ‚è∏, ‚èπ, üê¢, ‚öñ, ‚ö°) simuloituun uusintatoistoon.
* **Zoom-napit:** Yl√§palkista l√∂ytyv√§t zoom-napit (Ôºã/‚àí) muuttavat chatti- ja editorifontin kokoa turvallisissa rajoissa. Muutos tallentuu `config.json`-tiedostoon.
* **Varmempi tallennus:** Keskusteluhistoria tallentuu nyt riippumatta siit√§ selaatko tallenteita tai toistatko vanhoja viestej√§. Tallennus ja toiston√§kym√§n p√§ivitykset on eriytetty toisistaan.

---

## 9. K√§ytt√∂- ja testikomennot

```bash
python -m venv .venv            # (valinnainen) erillinen ymp√§rist√∂
.venv/Scripts/activate          # Windows PowerShell
pip install -r requirements.txt
python jugiai.py                                # K√§ynnist√§ k√§ytt√∂liittym√§
python -m unittest discover -s tests            # Aja yksikk√∂testit
python -m unittest tests.test_install_utf8_script  # Varmista asennusk√§√§reen eheys
```

### Vianetsint√§ ja varmistus

1. K√§ynnist√§ `python jugiai.py` ja varmista, ett√§ uusi tumma teema sek√§ zoom-painikkeet n√§kyv√§t.
2. L√§het√§ viesti ‚Üí avaa *Tallenteet* ‚Üí varmista, ett√§ viesti ilmestyy listaan ja toistopainikkeet toimivat.
3. S√§√§d√§ zoomia ¬± ja tarkista, ett√§ fonttikoko muuttuu my√∂s kirjoitusalueella.
4. Aja `install_utf8.bat` ‚Üí varmista, ett√§ lokirivit ovat JSON-muotoisia ja ett√§ koodisivu palautuu, kun ikkuna suljetaan.

---

## 10. Miksi t√§m√§ design

* **Teema yhten√§ist√§√§ br√§ndin:** K√§ytetyt v√§rit ja typografia seuraavat anomfin-website -sivuston kontrastia ja neon-korostuksia.
* **Tallenteiden toisto on sivuvaikutukseton:** Historiatoistin k√§ytt√§√§ vain muistissa olevaa listaa eik√§ est√§ `history.json`-tiedoston kirjoitusta.
* **Zoom on saavutettava:** Fonttikoon rajaaminen varmistaa luettavuuden eik√§ riko layouttia.
* **Testattava ydin:** Zoom- ja toistonopeuslogiikka kapseloitiin `playback_utils.py`-tiedostoon, jota yksikk√∂testit kattavat.
* **UTF-8-k√§√§re on idempotentti:** `install_utf8.bat` palauttaa alkuper√§isen koodisivun ja raportoi JSON-lokeilla, joten se on turvallista ajaa my√∂s skriptien sis√§lt√§.

---

## 11. Seuraavat iteroinnit

1. **√Ñ√§nitallenteet:** Mahdollista √§√§ni- ja videoliitteiden esikatselu Tallenteet-n√§kym√§ss√§.
2. **Haku tallenteista:** Lis√§√§ hakukentt√§, joka suodattaa historiaa roolin, avainsanan tai aikaleiman perusteella.
3. **Export to PDF/Markdown:** Tarjoa pikatoiminto keskusteluhistorian vientiin yhdeksi tiedostoksi.

---

**¬© 2024 AnomFIN ¬∑ Intelligent Experiences**
